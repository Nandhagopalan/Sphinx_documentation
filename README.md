# HTML Documentation Example

This repo describes how to setup (mostly) automated html documentation generation, hosted on the project's [GitHub Pages](https://pages.github.com/) page. HTML files are generated by [Sphinx](http://www.sphinx-doc.org/en/master/), based on [restructured text](https://thomas-cokelaer.info/tutorials/sphinx/rest_syntax.html) or [markdown](https://commonmark.org/) documents.


Follow the steps below to create html documentation in your project.

### 1. Install necessary dependencies
    
    $ pip3 install Sphinx sphinx-rtd-theme sphinx-copybutton sphinx-markdown-tables recommonmark
   
`sphinx-rtd-theme` is an optional (but nice) style for the documentation.

### 2. Setup sphinx
   
From the base directory of your project repo

    $ mkdir -p docs && cd docs
    $ sphinx-quickstart

Follow the prompts, filling in values as appropriate for your project.
You will likely want to enable the Sphinx `autodoc` and 'githubpages' extensions,
and the `viewcode` extension is also very nice. Others you can choose to include or not, depending on the particulars of your project.

### 3. Tweak the Sphinx configuration

The previous step will generate a number of files in the `docs/` directory. 
Sphinx configuration is contained in `docs/conf.py`, which will need a few changes.
Manually add `'sphinx.ext.napoleon'` to the `extensions` list if you want to use
Goggle- or numpy-style docstrings in your python code (as opposed to the richer but more difficult
to read as raw text rst format preferred by sphinx).

Additionally, change the `pygments_style` to `'sphinx'`  to have nicely formatted syntax highlighting for source code snippets in your documentation.

If you want to change from the default alabaster theme, change the line

    html_theme = 'alabaster'

For example,

    import sphinx_rtd_theme
    html_theme = 'sphinx_rtd_theme'
    html_theme_path = [sphinx_rtd_theme.get_html_theme_path()]
    
### 4. Create files needed by GitHub Pages

* Include an (empty) `.nojekyll`file in the `docs/` directory.

       $ touch .nojekyll

* Tell GitHub to redirect to your generated html files by creating a `docs/index.html` file containing the line

    
       <meta http-equiv="refresh" content="0; url=./_build/html/index.html" />

### 5. Generate the html pages

From within the `docs/` directory, the command

    $ make html

will generate your project's html pages.
Make sure to add the created files in `docs/build/html` to your repo. They need to be present, at least on the master branch, for github to display them.

To preview the generated files, you can use python's built in http server via

    python3 -m http.server PORTNUMBER

The webpage will be visible at `localhost:PORTNUMBER` if running locally, or at `HOSTURL:PORTNUMBER` if running on a remote machine (such as oscar). If running through docker, you will have to remap to port being used.

### 6. Enable your github page

On the project's github page, click on the Settings tab. Scroll down to the GitHub Pages section and change Source from "None" to "master branch /docs folder".

After pushing your html files to the repo, they should be used to automatically generate the project's GitHub Page, although sometimes it takes a few minutes for the changes to propogate. The link is displayed within the Settings section.
   
### 7. Enable automatic API documentation

To automatically create documentation from your source code's docstrings, you can create the
required rst files using 

    $ sphinx-apidoc -o DESTDIR PATH_TO_SOURCE_CODE

For example,

    $ sphinx-apidoc -o source ../src

(ran from the `docs/` directory) places the generated rst files in `docs/source`.
This will need to be re-run whenever you change the api (add modules, classes, or functions).
Just include `docs/source/modules.rst` somewhere for the entire
API documentation to appear. For example,

    
    .. toctree::
       :maxdepth: 2
       :caption: Contents:

       source/modules


### Optional: Enable Markdown

To add markdown files to the documentation:

1. `pip install recommonmark`
2. make the following additions to `conf.py`

```python
#add recommonmark to extensions
extensions = ['recommonmark']

#add .md to source_suffixes
source_suffix = ['.rst','.md']
```

Markdown files can now be referenced in `index.rst`, for example:

```
.. toctree::
   :maxdepth: 2 
   :caption: Model Monitoring
   
   /source/Model-Predictions.md
   /source/Aggregate-Metrics.md
```

**Note:** the markdown files must follow [commonmark](https://commonmark.org/) conventions.

### Optional: Add a "copy" Button to Code Blocks

1. `pip install sphinx-copybutton`
2. make the following additions to `conf.py`
```python
extensions = ['sphinx_copybutton']
```

<details>


* The copy button applies to all code blocks
* The copy button does not work the same with all sphinx themes
  * Can be customized with minor css modifications 
  * For more details see: https://sphinx-copybutton.readthedocs.io/en/latest/
</details>

# Latexpdf

In linux, execute the following steps to generate pdf for the project:

1. `sudo apt-get install -y latexmk texlive-latex-extra`
2. `make latexpdf` (inside docs folder)
